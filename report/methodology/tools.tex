\section{Tools}
\label{sec:tools}

\subsection{Shell scripts}
\label{sec:undervolt-test.sh}

The script used in §\ref{sec:unstableOPPs} to assist us in collecting data
regarding which OPPs result in a system crash is given in Listing
\ref{lst:undervolt-test.sh}.

\lstinputlisting[language=Bash,caption={\label{lst:undervolt-test.sh}
    Shell script to determine critical points — \code{undervolt-test.sh}}]
    {undervolt-test.sh}

The script takes the frequency to test in MHz as its first argument, e.g.
\code{2600} for 2600 MHz, and optionally takes a second argument, \code{all}.
If \code{all} is specified, we test all voltage offsets listed in the file
\code{undervolt-list.txt}, which is given in Listing \ref{lst:undervolt-list.txt}.
These voltage offsets are expressed in millivolts (units of
$\frac{1}{1000}$~volts) rather than the MSR interface's expected units of
$\frac{1}{1024}$~volts, as these numbers are fed into the \code{undervolt}
program utility, which then rounds the given value in millivolts to the nearest
multiple of $\frac{1}{1024}$~volts, and writes the appropriate value to the MSR.

\lstinputlisting[caption={\label{lst:undervolt-list.txt}
    Imprecise list of voltage offsets to test for all frequencies, in
    millivolts — \code{undervolt-list.txt}}]
    {undervolt-list.txt}

\subsection{Kernel modules}

[TBD]

We create a custom \code{sha1sum} binary which changes the core voltage during its
execution.
Need to execute in kernel mode so that MSRs can be read/written in order to
change the voltage.
We create a custom kernel module for this purpose which computes SHA-1 hash
when inserted into the kernel via \code{insmod}.

====

In order to demonstrate that it is possible to use a \clkscrew style attack on
this platform, we attempt to compute an incorrect SHA-1 hash of some data. The
process is as follows:

\begin{enumerate}
    \item Choose a known critical point.
    \item Put the system into a stable OPP near the chosen critical point.
    \item Begin computing the SHA-1 hash.
    \item Whilst the hash is being computed, temporarily put the system into an
        unstable OPP near the chosen critical point.
    \item The hash computation ends, and we hope to see an incorrect hash.
\end{enumerate}

To conduct this process, an attacker would need access to read from and write to
the necessary MSR. This is ultimately done via execution of the assembly-level
\code{RDMSR} and \code{WRMSR} instructions of the x86
architecture~\cite[Vol. 2, §§4.3–4]{intelDevManual}, 
