We use GCC's inline assembler~\cite{guyverCode} to write a C function which
allows the module to write to the MSR with address 0x150, and then develop some
additional abstractions so that the appropriate value is written to the MSR in
order to set the core voltage offset as required. We then
alter the hash computation code so that the system is temporarily put into an
unstable OPP as in step~\ref{item:induceFault} above.

To this end, we have written a kernel module dubbed \code{bad\_sha} which sets
the core voltage offset as required whilst it computes a SHA-1 hash. The 
functions which we have added or which differ from those in~\cite{gnupgSHA}
can be seen in Listing~\ref{lst:bad-sha.c}; note that \code{main} has been
renamed to \code{main\_routine}. The header file \code{msr.h} which contains
the functions for writing to MSRs can be seen in Listing~\ref{lst:msr.h}.
